var carrier = require('carrier'),
    dateFormat = require('dateformat');

exports.create = function(options) {
    var ts = new TS();

    if (!options) {
        options = {};
    }

    if (options.format) {
        ts.format = options.format;
    }

    return ts;
};

function TS() {
    // see format here: http://blog.stevenlevithan.com/archives/date-time-format
    this.format = '[yyyy-mm-dd HH:MM:ss]: ';
}

TS.prototype.bind = function(stream) {
    var that = this;
    carrier.carry(stream, function(line) {
        that._onLine(line);
    });
};

TS.prototype._onLine = function(line) {
    var now = new Date();
    var prefix = dateFormat(now, this.format);
    console.log(prefix + line);
};
